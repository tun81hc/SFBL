/*
 * SHE.c
 *
 *  Created on: Jun 18, 2019
 *      Author: AUP81HC
 */
#include "SHE.h"
#include "string.h"

#define Nb 4
#define Nk 4        // The number of 32 bit words in a key.
#define Nr 10       // The number of rounds in AES Cipher.

typedef uint8_t state_t[4][4];




void CND_ENC_ECB(struct AES_ctx ctx, uint8_t Key_ID, uint8_t* PlainText, uint8_t* CipherText)
{
	  unsigned char Key[16];
	  Select_Key(Key_ID, Key);
	  AES_init_ctx(&ctx, Key);
	  AES_ECB_encrypt(&ctx, PlainText, CipherText);
}


void CND_DEC_ECB(struct AES_ctx ctx, uint8_t* CipherText)
{
	AES_ECB_decrypt(&ctx, CipherText);
}


//CBC Encryption Process
void CND_ENC_CBC_START(struct AES_ctx ctx, uint8_t Key_ID, uint8_t* Key)
{
	Select_Key(Key_ID, Key);
	AES_init_ctx(&ctx, Key);
}


void CND_ENC_CBC_UPDATE(uint8_t Key_ID, uint8_t* PlainText, uint32_t length, uint8_t* CipherText)
{

}

void CND_ENC_CBC_FINISH(uint8_t Key_ID, uint8_t* PlainText, uint32_t length, uint8_t* CipherText)
{

}



void CND_DEC_CBC(uint8_t Key_ID, uint8_t* CipherText, uint32_t length)
{

}


void Select_Key(uint8_t Key_ID, unsigned char *Key)
{
 	unsigned char Key1[] = {0x2b,0x7e,0x15,0x16,0x28,0xae,0xd2,0xa6,0xab,0xf7,0x15,0x88,0x09,0xcf,0x4f,0x3c};


 	switch(Key_ID){
 	case 1:
 		memcpy(Key1, Key, 16);
 		break;

 	case 2:
 		break;

 	default:
 		break;

 	}
}
